# Rochelle Knight, Venexia Walker, et al., 2024.

import sys, csv, re

codes = [{"code":"702369008","system":"icd10"},{"code":"B48z.","system":"icd10"},{"code":"B50z.","system":"icd10"},{"code":"B555.","system":"icd10"},{"code":"BB17.","system":"icd10"},{"code":"BBk0.","system":"icd10"},{"code":"B56z.","system":"icd10"},{"code":"BBVz.","system":"icd10"},{"code":"BB5jz","system":"icd10"},{"code":"B43z.","system":"icd10"},{"code":"BBg10","system":"icd10"},{"code":"BBV1.","system":"icd10"},{"code":"B61z8","system":"icd10"},{"code":"BB812","system":"icd10"},{"code":"BB9B.","system":"icd10"},{"code":"BB5Uz","system":"icd10"},{"code":"B34z.","system":"icd10"},{"code":"B576z","system":"icd10"},{"code":"BBEz.","system":"icd10"},{"code":"B12z.","system":"icd10"},{"code":"B59z.","system":"icd10"},{"code":"BB5Wz","system":"icd10"},{"code":"B11z.","system":"icd10"},{"code":"B410z","system":"icd10"},{"code":"BB9M.","system":"icd10"},{"code":"BB5Lz","system":"icd10"},{"code":"BB9F.","system":"icd10"},{"code":"B1zz.","system":"icd10"},{"code":"BBgL.","system":"icd10"},{"code":"B66z.","system":"icd10"},{"code":"BB5T1","system":"icd10"},{"code":"BB5Vz","system":"icd10"},{"code":"B41yz","system":"icd10"},{"code":"B18z.","system":"icd10"},{"code":"BBgR.","system":"icd10"},{"code":"B30z.","system":"icd10"},{"code":"BBnz.","system":"icd10"},{"code":"B02z.","system":"icd10"},{"code":"B41z.","system":"icd10"},{"code":"B680.","system":"icd10"},{"code":"B24z.","system":"icd10"},{"code":"B04z.","system":"icd10"},{"code":"B07z.","system":"icd10"},{"code":"B623z","system":"icd10"},{"code":"B18yz","system":"icd10"},{"code":"B10z.","system":"icd10"},{"code":"B312z","system":"icd10"},{"code":"B61z.","system":"icd10"},{"code":"B327z","system":"icd10"},{"code":"B55y0","system":"icd10"},{"code":"BBr6z","system":"icd10"},{"code":"BBg3.","system":"icd10"},{"code":"BBG1.","system":"icd10"},{"code":"B241z","system":"icd10"},{"code":"B682.","system":"icd10"},{"code":"B150z","system":"icd10"},{"code":"B35zz","system":"icd10"},{"code":"BBr01","system":"icd10"},{"code":"BBL4.","system":"icd10"},{"code":"B510z","system":"icd10"},{"code":"B17yz","system":"icd10"},{"code":"B62y2","system":"icd10"},{"code":"B451z","system":"icd10"},{"code":"BB5Nz","system":"icd10"},{"code":"B62y.","system":"icd10"},{"code":"BBK2z","system":"icd10"},{"code":"B5504","system":"icd10"},{"code":"B55y1","system":"icd10"},{"code":"B561z","system":"icd10"},{"code":"B521z","system":"icd10"},{"code":"B01z.","system":"icd10"},{"code":"B62y1","system":"icd10"},{"code":"B5505","system":"icd10"},{"code":"B340z","system":"icd10"},{"code":"BB5Sz","system":"icd10"},{"code":"B180z","system":"icd10"},{"code":"B65z.","system":"icd10"},{"code":"B575z","system":"icd10"},{"code":"B314z","system":"icd10"},{"code":"B565z","system":"icd10"},{"code":"BBg1.","system":"icd10"},{"code":"BB69z","system":"icd10"},{"code":"B111z","system":"icd10"},{"code":"BB5P.","system":"icd10"},{"code":"B52z.","system":"icd10"},{"code":"B5503","system":"icd10"},{"code":"BB29.","system":"icd10"},{"code":"B1z1z","system":"icd10"},{"code":"B48yz","system":"icd10"},{"code":"B313z","system":"icd10"},{"code":"BB31.","system":"icd10"},{"code":"BBr02","system":"icd10"},{"code":"B44z.","system":"icd10"},{"code":"BBrz.","system":"icd10"},{"code":"BB5D5","system":"icd10"},{"code":"BB5z.","system":"icd10"},{"code":"B601z","system":"icd10"},{"code":"B14z.","system":"icd10"},{"code":"BB815","system":"icd10"},{"code":"B4A1z","system":"icd10"},{"code":"B62y3","system":"icd10"},{"code":"BB5az","system":"icd10"},{"code":"BBgB.","system":"icd10"},{"code":"BB82z","system":"icd10"},{"code":"B67z.","system":"icd10"},{"code":"B625z","system":"icd10"},{"code":"B626z","system":"icd10"},{"code":"BB12.","system":"icd10"},{"code":"B523z","system":"icd10"},{"code":"B13z.","system":"icd10"},{"code":"B304z","system":"icd10"},{"code":"B55z.","system":"icd10"},{"code":"B305z","system":"icd10"},{"code":"B430z","system":"icd10"},{"code":"B450z","system":"icd10"},{"code":"B05z.","system":"icd10"},{"code":"B322z","system":"icd10"},{"code":"B61zz","system":"icd10"},{"code":"BB11.","system":"icd10"},{"code":"B620z","system":"icd10"},{"code":"B58z.","system":"icd10"},{"code":"142Z.","system":"icd10"},{"code":"B315z","system":"icd10"},{"code":"BB5cz","system":"icd10"},{"code":"BB93.","system":"icd10"},{"code":"B5512","system":"icd10"},{"code":"BB13.","system":"icd10"},{"code":"B23z.","system":"icd10"},{"code":"B011z","system":"icd10"},{"code":"B62z.","system":"icd10"},{"code":"BBE1.","system":"icd10"},{"code":"B21z.","system":"icd10"},{"code":"B471z","system":"icd10"},{"code":"B431z","system":"icd10"},{"code":"B20z.","system":"icd10"},{"code":"BB2A.","system":"icd10"},{"code":"BBEQ.","system":"icd10"},{"code":"BBK02","system":"icd10"},{"code":"BBK31","system":"icd10"},{"code":"BBsz.","system":"icd10"},{"code":"B551z","system":"icd10"},{"code":"B6302","system":"icd10"},{"code":"BBgG.","system":"icd10"},{"code":"BBED.","system":"icd10"},{"code":"BB5f1","system":"icd10"},{"code":"B5500","system":"icd10"},{"code":"B5502","system":"icd10"},{"code":"B564z","system":"icd10"},{"code":"BBb5.","system":"icd10"},{"code":"BBgK.","system":"icd10"},{"code":"BB5Bz","system":"icd10"},{"code":"B614z","system":"icd10"},{"code":"B64yz","system":"icd10"},{"code":"B574z","system":"icd10"},{"code":"BBQ7z","system":"icd10"},{"code":"BBL9.","system":"icd10"},{"code":"B31z.","system":"icd10"},{"code":"BBbz.","system":"icd10"},{"code":"BBg5.","system":"icd10"},{"code":"B17z.","system":"icd10"},{"code":"B010z","system":"icd10"},{"code":"BB2B.","system":"icd10"},{"code":"B4Az.","system":"icd10"},{"code":"BBW4.","system":"icd10"},{"code":"B583z","system":"icd10"},{"code":"B651z","system":"icd10"},{"code":"B591.","system":"icd10"},{"code":"B213z","system":"icd10"},{"code":"B303z","system":"icd10"},{"code":"BB5Tz","system":"icd10"},{"code":"BBQ72","system":"icd10"},{"code":"B624z","system":"icd10"},{"code":"B55y2","system":"icd10"},{"code":"B590.","system":"icd10"},{"code":"BB22.","system":"icd10"},{"code":"BBLz.","system":"icd10"},{"code":"B5510","system":"icd10"},{"code":"BBn2.","system":"icd10"},{"code":"B61z7","system":"icd10"},{"code":"C333z","system":"icd10"},{"code":"BBjz.","system":"icd10"},{"code":"B57z.","system":"icd10"},{"code":"BBj6.","system":"icd10"},{"code":"BB19.","system":"icd10"},{"code":"B517z","system":"icd10"},{"code":"B581z","system":"icd10"},{"code":"BB5Mz","system":"icd10"},{"code":"BB81E","system":"icd10"},{"code":"BBr20","system":"icd10"},{"code":"B562z","system":"icd10"},{"code":"BBgJ.","system":"icd10"},{"code":"BB53.","system":"icd10"},{"code":"B62zz","system":"icd10"},{"code":"B055z","system":"icd10"},{"code":"B201z","system":"icd10"},{"code":"B22z.","system":"icd10"},{"code":"BBLA.","system":"icd10"},{"code":"B5511","system":"icd10"},{"code":"BB5Xz","system":"icd10"},{"code":"B681.","system":"icd10"},{"code":"B62y7","system":"icd10"},{"code":"B51z.","system":"icd10"},{"code":"B55yz","system":"icd10"},{"code":"B61z4","system":"icd10"},{"code":"BBr60","system":"icd10"},{"code":"BB5X1","system":"icd10"},{"code":"B6z..","system":"icd10"},{"code":"BBg..","system":"icd10"},{"code":"B222z","system":"icd10"},{"code":"BBQ71","system":"icd10"},{"code":"B013z","system":"icd10"},{"code":"B49z.","system":"icd10"},{"code":"B326z","system":"icd10"},{"code":"B602z","system":"icd10"},{"code":"B06z.","system":"icd10"},{"code":"B45z.","system":"icd10"},{"code":"B65yz","system":"icd10"},{"code":"BB801","system":"icd10"},{"code":"BB5hz","system":"icd10"},{"code":"B064z","system":"icd10"},{"code":"B550z","system":"icd10"},{"code":"BBj0.","system":"icd10"},{"code":"BBr90","system":"icd10"},{"code":"BB18.","system":"icd10"},{"code":"B61z1","system":"icd10"},{"code":"B68z.","system":"icd10"},{"code":"B553z","system":"icd10"},{"code":"BB85z","system":"icd10"},{"code":"B54z.","system":"icd10"},{"code":"B554.","system":"icd10"},{"code":"BBgD.","system":"icd10"},{"code":"B61z2","system":"icd10"},{"code":"B110z","system":"icd10"},{"code":"B62yz","system":"icd10"},{"code":"BBgz.","system":"icd10"},{"code":"B61z0","system":"icd10"},{"code":"B62y0","system":"icd10"},{"code":"B060z","system":"icd10"},{"code":"B62y8","system":"icd10"},{"code":"B560z","system":"icd10"},{"code":"BB43.","system":"icd10"},{"code":"B5z..","system":"icd10"},{"code":"BBF2.","system":"icd10"},{"code":"B470z","system":"icd10"},{"code":"B221z","system":"icd10"},{"code":"BB4z.","system":"icd10"},{"code":"BB80z","system":"icd10"},{"code":"B306z","system":"icd10"},{"code":"B540z","system":"icd10"},{"code":"B11yz","system":"icd10"},{"code":"B501z","system":"icd10"},{"code":"B307z","system":"icd10"},{"code":"B224z","system":"icd10"},{"code":"B615z","system":"icd10"},{"code":"B310z","system":"icd10"},{"code":"BBr04","system":"icd10"},{"code":"BBgC.","system":"icd10"},{"code":"B5501","system":"icd10"},{"code":"B62y6","system":"icd10"},{"code":"B613z","system":"icd10"},{"code":"BBkz.","system":"icd10"},{"code":"BBh0.","system":"icd10"},{"code":"B06yz","system":"icd10"},{"code":"B215.","system":"icd10"},{"code":"B03z.","system":"icd10"},{"code":"B2zz.","system":"icd10"},{"code":"BBr0z","system":"icd10"},{"code":"B220z","system":"icd10"},{"code":"B300z","system":"icd10"},{"code":"B200z","system":"icd10"},{"code":"B563z","system":"icd10"},{"code":"BBF1.","system":"icd10"},{"code":"B302z","system":"icd10"},{"code":"BBr03","system":"icd10"},{"code":"BBQ1z","system":"icd10"},{"code":"B071z","system":"icd10"},{"code":"B5530","system":"icd10"},{"code":"B325z","system":"icd10"},{"code":"B500z","system":"icd10"},{"code":"B63z.","system":"icd10"},{"code":"B323z","system":"icd10"},{"code":"B223z","system":"icd10"},{"code":"BB1J.","system":"icd10"},{"code":"B62y5","system":"icd10"},{"code":"BB52.","system":"icd10"},{"code":"B58yz","system":"icd10"},{"code":"BBr00","system":"icd10"},{"code":"B62y4","system":"icd10"},{"code":"B34yz","system":"icd10"},{"code":"B47z.","system":"icd10"},{"code":"B4z..","system":"icd10"},{"code":"B08z.","system":"icd10"},{"code":"B64z.","system":"icd10"},{"code":"B512z","system":"icd10"},{"code":"BBQ3.","system":"icd10"},{"code":"BBGM.","system":"icd10"},{"code":"BB24.","system":"icd10"}];
REQUIRED_CODES = 1;
with open(sys.argv[1], 'r') as file_in, open('ccu002_01-cancer-potential-cases.csv', 'w', newline='') as file_out:
    csv_reader = csv.DictReader(file_in)
    csv_writer = csv.DictWriter(file_out, csv_reader.fieldnames + ["ccu002_01-cancer-mcarcinosarcoma---secondary-identified"])
    csv_writer.writeheader();
    codes_identified = 0;
    for row in csv_reader:
        newRow = row.copy();
        for cell in row:
            # Iterate cell lists (e.g. codes)
            for item in re.findall(r'\(([^,]*)\,', row[cell]):
                if(item in list(map(lambda code: code['code'], codes))): codes_identified+=1;
                if(codes_identified>=REQUIRED_CODES):
                    newRow["ccu002_01-cancer-mcarcinosarcoma---secondary-identified"] = "CASE";
                    break;
            if(codes_identified>=REQUIRED_CODES): break;
        if(codes_identified<REQUIRED_CODES):
            newRow["ccu002_01-cancer-mcarcinosarcoma---secondary-identified"] = "UNK";
        codes_identified=0;
        csv_writer.writerow(newRow)
